<html><head><base href="." />
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>WePay - Pagos Digitales</title>
<style>
:root {
  --primary: #0070ba;
  --primary-dark: #003087;
  --secondary: #009cde;
  --light: #f7f9fa;
  --dark: #2c2e2f;
}

[data-theme="dark"] {
  --primary: #1a90ff;
  --primary-dark: #0066cc;
  --secondary: #00b0ff;
  --light: #1a1a1a;
  --dark: #ffffff;
  background: #121212;
  color: #ffffff;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', sans-serif;
}

body {
  background: var(--light);
  color: var(--dark);
}

.header {
  background: white;
  padding: 1rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
}

.nav-links {
  display: flex;
  gap: 2rem;
}

.hero {
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  padding: 6rem 2rem; /* Increased padding */
  text-align: center;
  min-height: 80vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.hero::before {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, rgba(255,255,255,0.1), transparent);
  animation: shine 8s infinite linear;
}

@keyframes shine {
  from { transform: translateX(-50%) rotate(0deg); }
  to { transform: translateX(50%) rotate(360deg); }
}

.hero h1 {
  font-size: 3.5rem;
  margin-bottom: 1.5rem;
  animation: fadeInUp 0.8s ease;
}

.hero p {
  font-size: 1.4rem;
  max-width: 600px;
  margin: 0 auto 2rem;
  opacity: 0.9;
  line-height: 1.6;
  animation: fadeInUp 1s ease;
}

.hero .btn {
  margin-top: 2rem;
  padding: 1rem 3rem;
  font-size: 1.2rem;
  animation: fadeInUp 1.2s ease;
}

.company-info {
  padding: 4rem 2rem;
  background: #fff;
  text-align: center;
}

.company-info h2 {
  color: var(--primary);
  margin-bottom: 2rem;
}

.company-description {
  max-width: 800px;
  margin: 0 auto 3rem;
  line-height: 1.8;
  color: #666;
}

.team-members {
  display: flex;
  justify-content: center;
  gap: 3rem;
  flex-wrap: wrap;
  margin-top: 3rem;
}

.team-member {
  text-align: center;
  max-width: 300px;
  padding: 2rem;
  border-radius: 12px;
  transition: transform 0.3s;
  background: var(--light);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.team-member:hover {
  transform: translateY(-5px);
}

.dashboard-welcome {
  text-align: center;
  padding: 3rem 2rem;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  margin-bottom: 2rem;
}

.dashboard-welcome h2 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.features {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  padding: 4rem 2rem;
  max-width: 1200px;
  margin: 0 auto;
}

.feature-card {
  background: white;
  padding: 2rem;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  text-align: center;
  transition: transform 0.3s ease;
}

.feature-card:hover {
  transform: translateY(-5px);
}

.btn {
  background: var(--primary);
  color: white;
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  text-decoration: none;
  display: inline-block;
  transition: background 0.3s ease;
}

.btn:hover {
  background: var(--primary-dark);
}

.btn-secondary {
  background: white;
  color: var(--primary);
  border: 2px solid var(--primary);
}

.btn-secondary:hover {
  background: var(--light);
}

.login-container, .register-container {
  max-width: 400px;
  margin: 4rem auto;
  padding: 2.5rem;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  animation: fadeInUp 0.8s ease;
}

.login-container h2 {
  text-align: center;
  color: var(--primary);
  margin-bottom: 2rem;
  font-size: 2rem;
}

.login-container .form-group {
  margin-bottom: 1.8rem;
}

.login-container .form-group label {
  display: block;
  margin-bottom: 0.8rem;
  color: var(--dark);
  font-weight: 500;
}

.login-container .form-group input {
  width: 100%;
  padding: 1rem;
  border: 2px solid #eee;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.login-container .form-group input:focus {
  border-color: var(--primary);
  outline: none;
}

.login-container .btn {
  width: 100%;
  padding: 1rem;
  font-size: 1.1rem;
  margin-top: 1rem;
  background: var(--primary);
  transition: transform 0.2s;
}

.login-container .btn:hover {
  transform: translateY(-2px);
}

.dashboard {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 2rem;
}

.balance-card {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  padding: 2rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
}

.balance-card::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    rgba(255,255,255,0.1),
    rgba(255,255,255,0.05)
  );
  transform: rotate(30deg);
  pointer-events: none;
}

.transaction-list {
  background: white;
  border-radius: 8px;
  padding: 1rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.transaction-item {
  animation: slideIn 0.3s ease;
  background: white;
  margin-bottom: 0.5rem;
  border-radius: 4px;
  padding: 1rem;
  transition: transform 0.2s;
}

.transaction-item:hover {
  transform: translateX(5px);
  background: var(--light);
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.transaction-item:last-child {
  border-bottom: none;
}

.grid-dashboard {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.quick-action {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: transform 0.3s;
  margin: 1rem;
}

.quick-action:hover {
  transform: translateY(-5px);
}

.quick-action .btn {
  margin-top: 1rem;
  width: 100%;
  padding: 1rem;
}

.hidden {
  display: none;
}

.gift-card {
  background: linear-gradient(45deg, #f3904f, #3b4371);
  color: white;
  padding: 2rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  text-align: center;
  animation: giftCardGlow 2s infinite alternate;
}

.gift-card input {
  padding: 0.75rem;
  border: none;
  border-radius: 4px;
  width: 80%;
  max-width: 300px;
  margin: 1rem 0;
  font-size: 1.2rem;
  text-align: center;
  letter-spacing: 2px;
}

@keyframes giftCardGlow {
  from {
    box-shadow: 0 0 10px rgba(243, 144, 79, 0.5);
  }
  to {
    box-shadow: 0 0 20px rgba(243, 144, 79, 0.8);
  }
}

.marketplace {
  background: white;
  border-radius: 8px;
  padding: 4rem 2rem;
  margin-top: 2rem;
}

.create-object {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  padding: 2rem;
  border-radius: 12px;
  margin-bottom: 2rem;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  max-width: 600px;
  margin: 0 auto 2rem;
}

.create-object h4 {
  font-size: 1.5rem;
  margin-bottom: 1.5rem;
  text-align: center;
}

.create-object .form-group {
  display: grid;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.create-object input,
.create-object textarea {
  padding: 1rem;
  border: none;
  border-radius: 8px;
  background: rgba(255,255,255,0.1);
  color: white;
  backdrop-filter: blur(10px);
}

.create-object input::placeholder,
.create-object textarea::placeholder {
  color: rgba(255,255,255,0.7);
}

.create-object .btn {
  width: 100%;
  padding: 1rem;
  font-size: 1.1rem;
  background: white;
  color: var(--primary);
  transition: transform 0.3s;
}

.create-object .btn:hover {
  transform: translateY(-2px);
  background: var(--light);
}

.objects-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
  padding: 1rem;
}

.object-card {
  background: var(--light);
  padding: 1.5rem;
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s;
  border: 1px solid #eee;
}

.object-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.object-card .description {
  color: #666;
  margin: 0.5rem 0;
  font-size: 0.9rem;
}

.object-card .price {
  font-size: 1.2rem;
  font-weight: bold;
  color: var(--primary);
  margin: 0.5rem 0;
}

.object-card .seller {
  font-size: 0.8rem;
  color: #888;
  margin-bottom: 1rem;
}

.events-section {
  background: white;
  border-radius: 8px;
  padding: 1rem;
  margin-top: 2rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.events-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 1rem;
  padding: 1rem;
}

.event-card {
  background: var(--light);
  padding: 1.5rem;
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s;
  border: 1px solid #eee;
}

.event-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.profile-section {
  max-width: 800px;
  margin: 2rem auto;
  padding: 3rem;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  border-radius: 15px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.profile-header {
  text-align: center;
  margin-bottom: 2rem;
}

.profile-avatar {
  width: 100px;
  height: 100px;
  margin: 0 auto 1rem;
}

.profile-section-card {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  padding: 2rem;
  border-radius: 12px;
  margin: 1rem 0;
}

.messaging-section {
  max-width: 800px;
  margin: 2rem auto;
  padding: 1rem;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.messages-container {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.messages-list {
  max-height: 400px;
  overflow-y: auto;
  padding: 1rem;
}

.message-item {
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 0.5rem;
  background: var(--light);
}

.new-message {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: 1rem;
}

.new-message textarea {
  min-height: 100px;
  resize: vertical;
}

.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 1rem;
  border-radius: 4px;
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  animation: slideIn 0.3s ease;
  z-index: 1000;
}

.notification.success {
  border-left: 4px solid #4caf50;
}

.notification.error {
  border-left: 4px solid #f44336;
}

.back-button {
  position: fixed;
  bottom: 20px;
  right: 20px;
  padding: 1rem;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  z-index: 100;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

@media (max-width: 768px) {
  .nav-links {
    display: none;
  }
}

[data-theme="dark"] .header,
[data-theme="dark"] .feature-card,
[data-theme="dark"] .login-container,
[data-theme="dark"] .register-container,
[data-theme="dark"] .profile-section,
[data-theme="dark"] .transaction-list,
[data-theme="dark"] .quick-action,
[data-theme="dark"] .marketplace,
[data-theme="dark"] .events-section,
[data-theme="dark"] .company-info {
  background: #242424;
  color: #ffffff;
}

[data-theme="dark"] input,
[data-theme="dark"] textarea,
[data-theme="dark"] select {
  background: #333;
  color: white;
  border-color: #444;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.footer {
  background: var(--primary-dark);
  color: white;
  padding: 3rem 2rem 1rem;
  margin-top: 4rem;
}

.footer-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 2rem;
  max-width: 1200px;
  margin: 0 auto;
}

.footer-section h4 {
  margin-bottom: 1rem;
  color: var(--secondary);
}

.footer-bottom {
  text-align: center;
  padding-top: 2rem;
  margin-top: 2rem;
  border-top: 1px solid rgba(255,255,255,0.1);
}
</style>
</head>
<body>

<header class="header">
  <nav class="nav">
    <div class="logo-container">
      <svg width="120" height="40" viewBox="0 0 120 40">
        <text x="10" y="30" fill="var(--primary)" font-size="24" font-weight="bold">WePay</text>
      </svg>
    </div>
    <div class="nav-links">
      <button class="btn btn-secondary" onclick="showLogin()">Iniciar Sesión</button>
      <button class="btn" onclick="showRegister()">Registrarse</button>
    </div>
  </nav>
</header>

<div id="landingContent">
<section class="hero">
  <h1>WePay - El Futuro de los Pagos Digitales</h1>
  <p>Una plataforma innovadora que revoluciona la forma en que realizamos transacciones digitales. Seguro, rápido y eficiente.</p>
  <div>
    <a href="https://example.com/registro" class="btn" onclick="handleBeginButton()">Comenzar ahora</a>
  </div>
</section>

<section class="company-info">
  <h2>Nuestra Historia</h2>
  <p class="company-description">
    WePay fue fundada en 2023 por ZDeAragon, un visionario en el campo de los pagos digitales. 
    Nuestra misión es revolucionar la forma en que las personas realizan transacciones, 
    proporcionando una plataforma segura, rápida y fácil de usar.
  </p>
  
  <div class="team-members">
    <div class="team-member">
      <h3>ZDeAragon</h3>
      <p>Fundador & Director de Innovación</p>
      <p class="quote">"Mi visión es crear una plataforma que transforme la manera en que 
      manejamos el dinero digital, haciendo las transacciones más seguras y accesibles para todos."</p>
    </div>
    
    <div class="team-member">
      <h3>Gabriel Rubio Montero</h3>
      <p>CEO & Director Ejecutivo</p>
      <p class="quote">"En WePay, nos esforzamos por brindar la mejor experiencia de usuario, 
      combinando tecnología innovadora con un servicio excepcional."</p>
    </div>
  </div>
</section>
</div>

<div id="loginForm" class="login-container hidden">
  <h2>Iniciar Sesión</h2>
  <form onsubmit="handleLogin(event)">
    <div class="form-group">
      <label for="loginEmail">Usuario</label>
      <input type="text" id="loginEmail" required>
    </div>
    <div class="form-group">
      <label for="loginPassword">Contraseña</label>
      <input type="password" id="loginPassword" required>
    </div>
    <button type="submit" class="btn">Iniciar Sesión</button>
  </form>
</div>

<div id="registerForm" class="register-container hidden">
  <h2>Registrarse</h2>
  <form onsubmit="handleRegister(event)">
    <div class="form-group">
      <label for="registerName">Nombre</label>
      <input type="text" id="registerName" required>
    </div>
    <div class="form-group">
      <label for="registerEmail">Email</label>
      <input type="email" id="registerEmail" required>
    </div>
    <div class="form-group">
      <label for="registerPassword">Contraseña</label>
      <input type="password" id="registerPassword" required>
    </div>
    <div class="form-group">
      <label for="confirmPassword">Confirmar Contraseña</label>
      <input type="password" id="confirmPassword" required>
    </div>
    <button type="submit" class="btn">Registrarse</button>
  </form>
</div>

<div id="dashboard" class="dashboard hidden">
  <div class="dashboard-welcome">
    <h2>Bienvenido, <span id="welcomeUsername"></span></h2>
    <p>Gestiona tus finanzas, realiza transacciones y más</p>
  </div>
  
  <div class="balance-card">
    <h2>Saldo Disponible</h2>
    <h1>$0.00</h1>
  </div>

  <div class="gift-card">
    <h3>¿Tienes una tarjeta de regalo?</h3>
    <p>Ingresa el código para canjear tu saldo</p>
    <input type="text" id="giftCardCode" placeholder="XXXX-XXXX-XXXX-XXXX" maxlength="19">
    <button class="btn" onclick="redeemGiftCard()">Canjear</button>
  </div>
  
  <div class="grid-dashboard">
    <div class="quick-action">
      <svg width="48" height="48" viewBox="0 0 64 64">
        <circle cx="32" cy="32" r="30" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <path d="M20 32h24M32 20v24" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <h3>Transferir</h3>
      <button class="btn" onclick="showTransferMessage()">Enviar dinero</button>
    </div>
    
    <div class="quick-action">
      <svg width="48" height="48" viewBox="0 0 64 64">
        <rect x="12" y="12" width="40" height="40" rx="4" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <path d="M20 32h24" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <h3>Eventos</h3>
      <button class="btn" onclick="showNoEventsMessage()">Ver eventos</button>
    </div>
    
    <div class="quick-action">
      <svg width="48" height="48" viewBox="0 0 64 64">
        <path d="M32 12v40M12 32h40" stroke="var(--primary)" stroke-width="2"/>
        <circle cx="32" cy="32" r="20" fill="none" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <h3>Objetos</h3>
      <button class="btn" onclick="showNoObjectsMessage()">Comprar</button>
    </div>

    <div class="quick-action">
      <svg width="48" height="48" viewBox="0 0 64 64">
        <circle cx="32" cy="32" r="30" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <circle cx="32" cy="25" r="12" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <path d="M16 60 Q32 40 48 60" fill="none" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <h3>Perfil</h3>
      <button class="btn" onclick="showProfile()">Ver Perfil</button>
    </div>

    <div class="quick-action">
      <svg width="48" height="48" viewBox="0 0 64 64">
        <rect x="8" y="16" width="48" height="32" rx="4" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <path d="M8 20l24 16 24-16" fill="none" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <h3>Mensajes</h3>
      <button class="btn" onclick="showMessages()">Ver Mensajes</button>
    </div>
  </div>

  <div class="transaction-list">
    <h3>Últimas Transacciones</h3>
    <div class="empty-transactions">
      <svg width="64" height="64" viewBox="0 0 64 64">
        <rect x="8" y="8" width="48" height="48" rx="4" fill="none" stroke="var(--primary)" stroke-width="2"/>
        <path d="M16 32h32M32 16v32" stroke="var(--primary)" stroke-width="2"/>
      </svg>
      <p>No hay transacciones realizadas</p>
    </div>
  </div>

  <div class="marketplace">
    <h3>Mercado de Objetos</h3>
    <div class="create-object">
      <h4>Crear Nuevo Objeto</h4>
      <div class="form-group">
        <input type="text" id="objectName" placeholder="Nombre del objeto">
        <input type="number" id="objectPrice" placeholder="Precio">
        <textarea id="objectDescription" placeholder="Descripción del objeto"></textarea>
        <button class="btn" onclick="createObject()">Crear Objeto</button>
      </div>
    </div>
    <div class="marketplace-search">
      <input type="text" 
             placeholder="Buscar objetos..." 
             oninput="searchObjects(this.value)"
             class="form-control">
    </div>
    <div id="objectsList" class="objects-list">
      <p style="padding: 1rem; text-align: center; color: #666;">No hay objetos disponibles</p>
    </div>
  </div>

  <div class="profile-section hidden" id="userProfile">
    <div class="profile-header">
      <h2>Perfil de Usuario</h2>
      <div class="profile-avatar">
        <svg width="100" height="100" viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="48" fill="var(--light)" stroke="var(--primary)" stroke-width="2"/>
          <circle cx="50" cy="40" r="20" fill="var(--primary)"/>
          <path d="M20 85 Q50 60 80 85" fill="var(--primary)"/>
        </svg>
      </div>
      <h3 id="profileUsername"></h3>
    </div>
    
    <div class="profile-content">
      <div class="profile-section-card">
        <h4>Datos Personales</h4>
        <div class="form-group">
          <label>Nombre Completo</label>
          <input type="text" id="profileFullName">
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="profileEmail">
        </div>
        <button class="btn" onclick="updateProfile()">Actualizar Datos</button>
      </div>

      <div class="profile-section-card">
        <h4>Preferencias</h4>
        <div class="form-group">
          <label>
            <input type="checkbox" id="notificationsEnabled">
            Recibir Notificaciones
          </label>
        </div>
        <div class="form-group">
          <label>Tema</label>
          <select id="themePreference">
            <option value="light">Claro</option>
            <option value="dark">Oscuro</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="messaging-section hidden" id="messaging">
    <div class="messages-container">
      <div class="messages-list" id="messagesList">
        <!-- Messages will be populated here -->
      </div>
      <div class="new-message">
        <select id="messageRecipient"></select>
        <textarea id="messageContent" placeholder="Escribe tu mensaje..."></textarea>
        <button class="btn" onclick="sendMessage()">Enviar</button>
      </div>
    </div>
  </div>

  <div id="transferScreen" class="transfer-screen hidden">
    <h2>Realizar Transferencia</h2>
    <form onsubmit="handleTransfer(event)">
      <select id="transferRecipient" required>
        <!-- populated dynamically -->
      </select>
      <input type="number" id="transferAmount" required min="0" step="0.01">
      <button type="submit" class="btn">Transferir</button>
    </form>
  </div>
</div>

<footer class="footer">
  <div class="footer-content">
    <div class="footer-section">
      <h4>WePay</h4>
      <p>Transformando el futuro de los pagos digitales</p>
    </div>
    <div class="footer-section">
      <h4>Contacto</h4>
      <p>ZDearagon@gmail.com</p>
      <p>+34 681 880 222</p>
    </div>
    <div class="footer-section">
      <h4>Legal</h4>
      <p>Términos y Condiciones</p>
      <p>Política de Privacidad</p>
    </div>
  </div>
  <div class="footer-bottom">
    <p>&copy; 2024 WePay. Todos los derechos reservados.</p>
  </div>
</footer>

<button onclick="goToMain()" class="back-button">
  <svg width="24" height="24" viewBox="0 0 24 24">
    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" 
          fill="currentColor"/>
  </svg>
</button>

<script>
const validAccounts = [ 
  {
    email: 'Guillermo',
    password: 'Guille07'
  },
  {
    email: 'Hugo', 
    password: 'Hugo14'
  },
  {
    email: 'Gabriel',
    password: 'Gabriel18'
  },
  {
    email: 'Martin',
    password: 'Martin17'
  }
];

let userTransactions = {};
let currentUser = null;
let currentBalance = 0;
let marketplaceObjects = []; // Empty initial marketplace
let events = []; // Empty initial events
localStorage.setItem('marketplaceObjects', JSON.stringify([]));
localStorage.setItem('events', JSON.stringify([]));
let userMessages = {};
let userProfiles = {};
let validGiftCards = {
  '1234-5678-9000-0000': {
    value: 100,
    used: false
  }
};
if (localStorage.getItem('validGiftCards')) {
  validGiftCards = JSON.parse(localStorage.getItem('validGiftCards'));
} else {
  localStorage.setItem('validGiftCards', JSON.stringify(validGiftCards));
}

if (localStorage.getItem('userProfiles')) {
  userProfiles = JSON.parse(localStorage.getItem('userProfiles'));
}

if (localStorage.getItem('userMessages')) {
  userMessages = JSON.parse(localStorage.getItem('userMessages'));
}

function handleLogin(event) {
  event.preventDefault();
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  const validAccounts = [ 
    {
      email: 'Guillermo',
      password: 'Guille07'
    },
    {
      email: 'Hugo', 
      password: 'Hugo14'
    },
    {
      email: 'Gabriel',
      password: 'Gabriel18'
    },
    {
      email: 'Martin',
      password: 'Martin17'
    }
  ];

  const account = validAccounts.find(acc => 
    acc.email.toLowerCase() === email.toLowerCase() && 
    acc.password === password
  );

  if (account) {
    currentUser = email.toLowerCase();
    
    currentBalance = parseFloat(localStorage.getItem(`balance_${currentUser}`)) || 0;
    
    if (!userTransactions[currentUser]) {
      userTransactions[currentUser] = [];
    }
    
    const bonusKey = `bonus_${currentUser}`;
    const wasGiven = localStorage.getItem(bonusKey);
    
    if (!wasGiven) {
      currentBalance += 1;
      localStorage.setItem(bonusKey, 'true');
      localStorage.setItem(`balance_${currentUser}`, currentBalance);
      alert('¡Bienvenido! Has recibido $1.00 de bono por tu primer inicio de sesión');
    }

    showDashboard();
    updateTransactionsList();
    document.querySelector('.balance-card h1').textContent = `$${currentBalance.toFixed(2)}`;
    document.getElementById('welcomeUsername').textContent = currentUser;
  } else {
    alert('Email o contraseña incorrectos');
  }
}

function showProfile() {
  document.querySelectorAll('.dashboard > div').forEach(div => div.classList.add('hidden'));
  document.getElementById('userProfile').classList.remove('hidden');
  
  loadUserProfile();
}

function loadUserProfile() {
  const profile = userProfiles[currentUser] || {};
  document.getElementById('profileUsername').textContent = currentUser;
  document.getElementById('profileFullName').value = profile.fullName || '';
  document.getElementById('profileEmail').value = profile.email || '';

  const userTrans = userTransactions[currentUser] || [];
  const transactionsList = document.querySelector('.transaction-list');
  transactionsList.innerHTML = userTrans.length ? 
    userTrans.map(t => `
      <div class="transaction-item">
        <span>${t.description}</span>
        <span class="${t.amount >= 0 ? 'positive' : 'negative'}">
          ${t.amount >= 0 ? '+' : ''}$${t.amount.toFixed(2)}
        </span>
      </div>
    `).join('') :
    '<p>No hay transacciones</p>';
}

function updateProfile() {
  const profile = {
    fullName: document.getElementById('profileFullName').value,
    email: document.getElementById('profileEmail').value,
    notifications: document.getElementById('notificationsEnabled').checked,
    theme: document.getElementById('themePreference').value
  };
  
  userProfiles[currentUser] = profile;
  localStorage.setItem('userProfiles', JSON.stringify(userProfiles));
  updateTheme(profile.theme);
  showNotification('Perfil actualizado correctamente');
}

function updateTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  localStorage.setItem('theme', theme);
}

function goToMain() {
  document.querySelectorAll('.dashboard > div').forEach(div => {
    if(div.classList.contains('balance-card') || 
       div.classList.contains('gift-card') || 
       div.classList.contains('grid-dashboard') ||
       div.classList.contains('transaction-list') ||
       div.classList.contains('marketplace')) {
      div.classList.remove('hidden');
    } else {
      div.classList.add('hidden');
    }
  });
  
  // Clean and update lists
  updateTransactionsList();
  updateObjectsList();
  updateEventsList();
}

function showMessages() {
  document.querySelectorAll('.dashboard > div').forEach(div => div.classList.add('hidden'));
  document.getElementById('messaging').classList.remove('hidden');
  
  const recipientSelect = document.getElementById('messageRecipient');
  // Add error handling
  if (typeof validAccounts !== 'undefined') {
    recipientSelect.innerHTML = validAccounts
      .map(acc => acc.email)
      .filter(email => email !== currentUser)
      .map(email => `<option value="${email}">${email}</option>`)
      .join('');
  } else {
    recipientSelect.innerHTML = '<option value="">No hay destinatarios disponibles</option>';
  }
    
  updateMessagesList();
}


function sendMessage() {
  const recipient = document.getElementById('messageRecipient').value;
  const content = document.getElementById('messageContent').value;
  
  if (!content.trim()) {
    showNotification('Por favor escribe un mensaje', 'error');
    return;
  }
  
  if (!userMessages[currentUser]) userMessages[currentUser] = [];
  if (!userMessages[recipient]) userMessages[recipient] = [];
  
  const message = {
    from: currentUser,
    to: recipient,
    content,
    date: new Date().toISOString()
  };
  
  userMessages[currentUser].push(message);
  userMessages[recipient].push(message);
  
  localStorage.setItem('userMessages', JSON.stringify(userMessages));
  document.getElementById('messageContent').value = '';
  updateMessagesList();
  showNotification('Mensaje enviado');
}

function updateMessagesList() {
  const messagesList = document.getElementById('messagesList');
  const messages = userMessages[currentUser] || [];
  
  if (messages.length === 0) {
    messagesList.innerHTML = '<p class="text-center">No hay mensajes</p>';
    return;
  }
  
  messagesList.innerHTML = messages
    .sort((a, b) => new Date(b.date) - new Date(a.date))
    .map(msg => `
      <div class="message-item">
        <div class="message-header">
          <strong>${msg.from === currentUser ? 'Tú' : msg.from}</strong>
          <span>${new Date(msg.date).toLocaleString()}</span>
        </div>
        <div class="message-content">${msg.content}</div>
      </div>
    `)
    .join('');
}

function updateBalance(amount) {
  currentBalance += amount;
  localStorage.setItem(`balance_${currentUser}`, currentBalance);
  document.querySelector('.balance-card h1').textContent = `$${currentBalance.toFixed(2)}`;
}

function redeemGiftCard() {
  const code = document.getElementById('giftCardCode').value;
  if (!code) {
    alert('Por favor ingresa un código de tarjeta de regalo');
    return;
  }
  
  if (code.length < 19) {
    alert('El código debe tener el formato XXXX-XXXX-XXXX-XXXX');
    return;
  }
  
  const giftCard = validGiftCards[code];
  if (giftCard && !giftCard.used) {
    updateBalance(giftCard.value);
    addTransaction(`Tarjeta de regalo canjeada`, giftCard.value);
    giftCard.used = true;
    localStorage.setItem('validGiftCards', JSON.stringify(validGiftCards));
    alert(`¡Código canjeado! Se han añadido ${giftCard.value} a tu saldo`);
    document.getElementById('giftCardCode').value = '';
  } else {
    alert('Código de tarjeta de regalo inválido o ya utilizado');
    document.getElementById('giftCardCode').value = '';
  }
}

function handleRegister(event) {
  event.preventDefault();
  alert('El registro de nuevas cuentas está deshabilitado. Por favor, utiliza una cuenta existente.');
}

function showTransferMessage() {
  const recipient = prompt("¿A quién deseas enviar dinero?");
  if (!recipient) return;
  
  const amount = parseFloat(prompt("¿Cuánto dinero deseas enviar?"));
  if (isNaN(amount) || amount <= 0) {
    alert("Por favor ingresa una cantidad válida");
    return;
  }

  if (amount > currentBalance) {
    alert("No tienes suficiente saldo");
    return;
  }

  updateBalance(-amount);
  addTransaction(`Envío a ${recipient}`, -amount);

  const recipientBalance = parseFloat(localStorage.getItem(`balance_${recipient}`)) || 0;
  localStorage.setItem(`balance_${recipient}`, recipientBalance + amount);
  
  alert(`Has enviado $${amount} a ${recipient}`);
}

function createObject() {
  const name = document.getElementById('objectName').value;
  const price = parseFloat(document.getElementById('objectPrice').value);
  const description = document.getElementById('objectDescription').value;
  
  if (!name || !price || !description) {
    alert('Por favor completa todos los campos');
    return;
  }

  const object = {
    id: Date.now(),
    name,
    price,
    description,
    seller: currentUser
  };

  marketplaceObjects.push(object);
  localStorage.setItem('marketplaceObjects', JSON.stringify(marketplaceObjects));
  updateObjectsList();
  
  document.getElementById('objectName').value = '';
  document.getElementById('objectPrice').value = '';
  document.getElementById('objectDescription').value = '';
}

function updateObjectsList(filteredObjects = marketplaceObjects) {
  const objectsList = document.getElementById('objectsList');
  if (filteredObjects.length === 0) {
    objectsList.innerHTML = '<p style="padding: 1rem; text-align: center; color: #666;">No hay objetos disponibles</p>';
    return;
  }

  objectsList.innerHTML = filteredObjects.map(obj => `
    <div class="object-card">
      <h4>${obj.name}</h4>
      <p class="description">${obj.description}</p>
      <p class="price">$${obj.price.toFixed(2)}</p>
      <p class="seller">Vendedor: ${obj.seller}</p>
      <button class="btn" onclick="purchaseObject(${obj.id})">Comprar</button>
    </div>
  `).join('');
}

function purchaseObject(id) {
  const object = marketplaceObjects.find(obj => obj.id === id);
  if (!object) return;

  if (currentBalance >= object.price) {
    // Update buyer balance
    updateBalance(-object.price);
    
    // Update seller balance
    const sellerBalance = parseFloat(localStorage.getItem(`balance_${object.seller}`)) || 0;
    localStorage.setItem(`balance_${object.seller}`, sellerBalance + object.price);
    
    // Remove object and update UI
    marketplaceObjects = marketplaceObjects.filter(obj => obj.id !== id);
    updateObjectsList();
    showNotification(`¡Compra exitosa! ${object.name}`, 'success');
  } else {
    alert('No tienes saldo suficiente para comprar este objeto');
  }
}

function searchObjects(query) {
  const filteredObjects = marketplaceObjects.filter(obj => 
    obj.name.toLowerCase().includes(query.toLowerCase()) ||
    obj.description.toLowerCase().includes(query.toLowerCase())
  );
  updateObjectsList(filteredObjects);
}

function showNoObjectsMessage() {
  document.querySelector('.marketplace').scrollIntoView({ behavior: 'smooth' });
}

function showNoEventsMessage() {
  const eventName = prompt("Crear nuevo evento - Nombre del evento:");
  if (!eventName) return;
  
  const eventCost = parseFloat(prompt("Costo de entrada:"));
  if (isNaN(eventCost) || eventCost < 0) {
    alert("Por favor ingresa un costo válido");
    return;
  }

  const event = {
    id: Date.now(),
    name: eventName,
    cost: eventCost,
    creator: currentUser,
    attendees: [],
    description: prompt("Descripción del evento:") || ""
  };

  events.push(event);
  localStorage.setItem('events', JSON.stringify(events));
  
  showNotification(`Evento "${eventName}" creado con éxito`);
  addTransaction(`Creación de evento: ${eventName}`, 0);
  updateEventsList();
}

function updateTransactionsList() {
  const transactionList = document.querySelector('.transaction-list');
  
  if (!userTransactions[currentUser] || userTransactions[currentUser].length === 0) {
    transactionList.innerHTML = `
      <h3>Últimas Transacciones</h3>
      <div class="empty-transactions">
        <svg width="64" height="64" viewBox="0 0 64 64">
          <rect x="8" y="8" width="48" height="48" rx="4" fill="none" stroke="var(--primary)" stroke-width="2"/>
          <path d="M16 32h32M32 16v32" stroke="var(--primary)" stroke-width="2"/>
        </svg>
        <p>No hay transacciones realizadas</p>
      </div>
    `;
    return;
  }

  let html = '<h3>Últimas Transacciones</h3>';
  html += '<div class="transactions-wrapper">';
  userTransactions[currentUser].forEach(trans => {
    html += `
      <div class="transaction-item">
        <div class="transaction-info">
          <span class="transaction-description">${trans.description}</span>
          <span class="transaction-date">${new Date(trans.date).toLocaleDateString()}</span>
        </div>
        <span class="transaction-amount ${trans.amount >= 0 ? 'positive' : 'negative'}">
          ${trans.amount >= 0 ? '+' : ''}$${Math.abs(trans.amount).toFixed(2)}
        </span>
      </div>
    `;
  });
  html += '</div>';
  
  transactionList.innerHTML = html;
}

function addTransaction(description, amount) {
  if (!userTransactions[currentUser]) {
    userTransactions[currentUser] = [];
  }
  
  userTransactions[currentUser].push({
    description,
    amount,
    date: new Date().toISOString()
  });
  
  updateTransactionsList();
}

function updateEventsList() {
  const existingEventsSections = document.querySelectorAll('.events-section');
  existingEventsSections.forEach(section => section.remove());

  const eventsHtml = events.map(event => `
    <div class="event-card">
      <h4>${event.name}</h4>
      <p>Costo: ${event.cost}</p>
      <p>Creador: ${event.creator}</p>
      <p>Participantes: ${event.attendees.length}</p>
      ${currentUser !== event.creator ? 
        `<button class="btn" onclick="joinEvent(${event.id})">Unirse</button>` : 
        '<span>Tu evento</span>'}
    </div>
  `).join('');
  
  const eventsSection = `
    <div class="events-section">
      <h3>Eventos Disponibles</h3>
      <div class="events-grid">
        ${events.length ? eventsHtml : '<p>No hay eventos disponibles</p>'}
      </div>
    </div>
  `;
  
  const marketplace = document.querySelector('.marketplace');
  marketplace.insertAdjacentHTML('beforebegin', eventsSection);
}

function joinEvent(eventId) {
  const event = events.find(e => e.id === eventId);
  if (!event) return;
  
  if (currentBalance >= event.cost) {
    updateBalance(-event.cost);
    event.attendees.push(currentUser);
    localStorage.setItem('events', JSON.stringify(events));
    addTransaction(`Unión a evento: ${event.name}`, -event.cost);
    alert(`Te has unido al evento "${event.name}"`);
    updateEventsList();
  } else {
    alert('No tienes saldo suficiente para unirte a este evento');
  }
}

function showNotification(message, type = 'success') {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, 3000);
}

function showDashboard() {
  document.getElementById('landingContent').classList.add('hidden');
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('registerForm').classList.add('hidden');
  document.getElementById('dashboard').classList.remove('hidden');
  updateObjectsList();
  updateEventsList();
}

function showLogin() {
  document.getElementById('landingContent').classList.add('hidden');
  document.getElementById('registerForm').classList.add('hidden');
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('loginForm').classList.remove('hidden');
}

function showRegister() {
  document.getElementById('landingContent').classList.add('hidden');
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('registerForm').classList.remove('hidden');
}

document.getElementById('giftCardCode').addEventListener('input', function(e) {
  let value = e.target.value.replace(/[^0-9]/g, '');
  let formattedValue = '';
  
  for (let i = 0; i < value.length && i < 16; i++) {
    if (i > 0 && i % 4 === 0) {
      formattedValue += '-';
    }
    formattedValue += value[i];
  }
  
  e.target.value = formattedValue;
});

document.addEventListener('DOMContentLoaded', function() {
  localStorage.clear(); // Add this to DOMContentLoaded to clear all stored data
  // Restore saved theme
  const savedTheme = localStorage.getItem('theme') || 'light';
  updateTheme(savedTheme);
  
  // Update theme select if exists
  const themeSelect = document.getElementById('themePreference');
  if(themeSelect) {
    themeSelect.value = savedTheme;
  }
  
  // Add theme change listener
  document.getElementById('themePreference')?.addEventListener('change', (e) => {
    updateTheme(e.target.value);
  });

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = 1;
        entry.target.style.transform = 'translateY(0)';
      }
    });
  });

  document.querySelectorAll('.feature-card').forEach((card) => {
    card.style.opacity = 0;
    card.style.transform = 'translateY(20px)';
    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
    observer.observe(card);
  });

  if (currentUser) {
    updateObjectsList();
    updateEventsList();
  }
});
</script>

</body>
</html>